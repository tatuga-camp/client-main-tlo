!function(){"use strict";let e,t;let r=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}};var o=tinymce.util.Tools.resolve("tinymce.PluginManager");let n=e=>({isEnabled:()=>e.get()}),l=(e,t)=>e.dispatch("VisualChars",{state:t}),s=(e,t,r)=>{var o;return!!r(e,t.prototype)||(null===(o=e.constructor)||void 0===o?void 0:o.name)===t.name},a=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&s(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},i=e=>t=>a(t)===e,u=e=>t=>typeof t===e,c=i("string"),d=i("object"),m=e=>null===e,h=u("boolean"),g=e=>null==e,v=e=>!g(e),f=u("number");class p{constructor(e,t){this.tag=e,this.value=t}static some(e){return new p(!0,e)}static none(){return p.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?p.some(e(this.value)):p.none()}bind(e){return this.tag?e(this.value):p.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:p.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return v(e)?p.some(e):p.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}p.singletonNone=new p(!1);let b=(e,t)=>{let r=e.length,o=Array(r);for(let n=0;n<r;n++){let r=e[n];o[n]=t(r,n)}return o},y=(e,t)=>{for(let r=0,o=e.length;r<o;r++)t(e[r],r)},w=(e,t)=>{let r=[];for(let o=0,n=e.length;o<n;o++){let n=e[o];t(n,o)&&r.push(n)}return r},k=Object.keys,N=(e,t)=>{let r=k(e);for(let o=0,n=r.length;o<n;o++){let n=r[o];t(e[n],n)}},A="undefined"!=typeof window?window:Function("return this;")(),T=(e,t)=>{let r=null!=t?t:A;for(let t=0;t<e.length&&null!=r;++t)r=r[e[t]];return r},C=(e,t)=>T(e.split("."),t),E=(e,t)=>C(e,t),O=(e,t)=>{let r=E(e,t);if(null==r)throw Error(e+" not available on this browser");return r},D=Object.getPrototypeOf,L=e=>O("HTMLElement",e),V=e=>{let t=C("ownerDocument.defaultView",e);return d(e)&&(L(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(D(e).constructor.name))},j=e=>e.dom.nodeType,B=e=>e.dom.nodeValue,S=e=>t=>j(t)===e,x=e=>M(e)&&V(e.dom),M=S(1),P=S(3),_=(e,t,r)=>{if(c(r)||h(r)||f(r))e.setAttribute(t,r+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",r,":: Element ",e),Error("Attribute value was not simple")},H=(e,t,r)=>{_(e.dom,t,r)},I=(e,t)=>{let r=e.dom.getAttribute(t);return null===r?void 0:r},$=(e,t)=>{e.dom.removeAttribute(t)},F=(e,t)=>{let r=I(e,t);return void 0===r||""===r?[]:r.split(" ")},K=(e,t,r)=>{let o=F(e,t).concat([r]);return H(e,t,o.join(" ")),!0},R=(e,t,r)=>{let o=w(F(e,t),e=>e!==r);return o.length>0?H(e,t,o.join(" ")):$(e,t),!1},U=e=>void 0!==e.dom.classList,q=e=>F(e,"class"),z=(e,t)=>K(e,"class",t),G=(e,t)=>R(e,"class",t),J=(e,t)=>{U(e)?e.dom.classList.add(t):z(e,t)},Q=e=>{0===(U(e)?e.dom.classList:q(e)).length&&$(e,"class")},W=(e,t)=>{U(e)?e.dom.classList.remove(t):G(e,t),Q(e)},X={fromDom:e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}}},Y={"\xa0":"nbsp","\xad":"shy"},Z=(e,t)=>{let r="";return N(e,(e,t)=>{r+=t}),RegExp("["+r+"]",t?"g":"")},ee=Z(Y),et=Z(Y,!0),er=(e="",N(Y,t=>{e&&(e+=","),e+="span.mce-"+t}),e),eo="mce-nbsp",en=e=>e.dom.contentEditable,el=e=>'<span data-mce-bogus="1" class="mce-'+Y[e]+'">'+e+"</span>",es=e=>"span"===e.nodeName.toLowerCase()&&e.classList.contains("mce-nbsp-wrap"),ea=e=>{let t=B(e);return P(e)&&c(t)&&ee.test(t)},ei=e=>x(e)&&"false"===en(e),eu=(e,t)=>{if(x(e)&&!es(e.dom)){let t=en(e);if("true"===t)return!0;if("false"===t)return!1}return t},ec=(e,t,r)=>{let o=[],n=b(e.dom.childNodes,X.fromDom),l=e=>es(e.dom)||!ei(e);return y(n,e=>{r&&l(e)&&t(e)&&(o=o.concat([e])),o=o.concat(ec(e,t,eu(e,r)))}),o},ed=(e,t)=>{for(;e.parentNode;){if(e.parentNode===t)return t;e=e.parentNode}},em=e=>e.replace(et,el),eh=(e,t)=>{let r=e.dom;y(ec(X.fromDom(t),ea,e.dom.isEditable(t)),t=>{var o;let n=t.dom.parentNode;if(es(n))J(X.fromDom(n),eo);else{let n;let l=em(r.encode(null!==(o=B(t))&&void 0!==o?o:"")),s=r.create("div",{},l);for(;n=s.lastChild;)r.insertAfter(n,t.dom);e.dom.remove(t.dom)}})},eg=(e,t)=>{y(e.dom.select(er,t),t=>{es(t)?W(X.fromDom(t),eo):e.dom.remove(t,!0)})},ev=e=>{let t=e.getBody(),r=e.selection.getBookmark(),o=ed(e.selection.getNode(),t);eg(e,o=void 0!==o?o:t),eh(e,o),e.selection.moveToBookmark(r)},ef=(e,t)=>{l(e,t.get());let r=e.getBody();!0===t.get()?eh(e,r):eg(e,r)},ep=(e,t)=>{t.set(!t.get());let r=e.selection.getBookmark();ef(e,t),e.selection.moveToBookmark(r)},eb=(e,t)=>{e.addCommand("mceVisualChars",()=>{ep(e,t)})},ey=e=>{(0,e.options.register)("visualchars_default_state",{processor:"boolean",default:!1})},ew=(t="visualchars_default_state",e=>e.options.get(t)),ek=(e,t)=>{e.on("init",()=>{ef(e,t)})},eN=(e,t)=>{let r=null;return{cancel:()=>{m(r)||(clearTimeout(r),r=null)},throttle:(...o)=>{m(r)&&(r=setTimeout(()=>{r=null,e.apply(null,o)},t))}}},eA=(e,t)=>{let r=eN(()=>{ev(e)},300);e.on("keydown",o=>{!0===t.get()&&(13===o.keyCode?ev(e):r.throttle())}),e.on("remove",r.cancel)},eT=(e,t)=>r=>{r.setActive(t.get());let o=e=>r.setActive(e.state);return e.on("VisualChars",o),()=>e.off("VisualChars",o)},eC=(e,t)=>{let r=()=>e.execCommand("mceVisualChars");e.ui.registry.addToggleButton("visualchars",{tooltip:"Show invisible characters",icon:"visualchars",onAction:r,onSetup:eT(e,t)}),e.ui.registry.addToggleMenuItem("visualchars",{text:"Show invisible characters",icon:"visualchars",onAction:r,onSetup:eT(e,t)})};o.add("visualchars",e=>{ey(e);let t=r(ew(e));return eb(e,t),eC(e,t),eA(e,t),ek(e,t),n(t)})}();