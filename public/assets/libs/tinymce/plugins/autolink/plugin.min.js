!function(){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager");let t=e=>t=>t.options.get(e),r=t("autolink_pattern"),o=t("link_default_target"),n=t("link_default_protocol"),l=t("allow_unsafe_link_target"),a=e=>"string"===(e=>{var t,r;let o=typeof e;return null===e?"null":"object"===o&&Array.isArray(e)?"array":"object"===o&&((t=String).prototype.isPrototypeOf(e)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name)?"string":o})(e),i=e=>void 0===e,s=e=>null!=e,d=Object.hasOwnProperty,u=e=>"\uFEFF"===e;var c=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker");let f=e=>/^[(\[{ \u00a0]$/.test(e),g=(e,t,r)=>{for(let o=t-1;o>=0;o--){let t=e.charAt(o);if(!u(t)&&r(t))return o}return -1},m=(e,t)=>{var o,l,a;let s=e.schema.getVoidElements(),u=r(e),{dom:m,selection:k}=e;if(null!==m.getParent(k.getNode(),"a[href]"))return null;let p=k.getRng(),y=c(m,e=>{var t;return m.isBlock(e)||(t=e.nodeName.toLowerCase(),d.call(s,t))||"false"===m.getContentEditable(e)}),{container:v,offset:w}=((e,t)=>{let r=e,o=t;for(;1===r.nodeType&&r.childNodes[o];)o=3===(r=r.childNodes[o]).nodeType?r.data.length:r.childNodes.length;return{container:r,offset:o}})(p.endContainer,p.endOffset),h=null!==(o=m.getParent(v,m.isBlock))&&void 0!==o?o:m.getRoot(),_=y.backwards(v,w+t,(e,t)=>{var r;let o=e.data,n=g(o,t,e=>!f(e));return -1===n||(r=o[n],/[?!,.;:]/.test(r))?n:n+1},h);if(!_)return null;let A=_.container,C=y.backwards(_.container,_.offset,(e,t)=>{A=e;let r=g(e.data,t,f);return -1===r?r:r+1},h),b=m.createRng();C?b.setStart(C.container,C.offset):b.setStart(A,0),b.setEnd(_.container,_.offset);let E=b.toString().replace(/\uFEFF/g,"").match(u);if(E){let t,r=E[0];return a="www.",(l=r).length>=4&&l.substr(0,4)===a?r=n(e)+"://"+r:((e,t,r=0,o)=>{let n=e.indexOf("@",r);return -1!==n&&(!!i(void 0)||n+1<=void 0)})(r,0)&&(t=r,!/^([A-Za-z][A-Za-z\d.+-]*:\/\/)|mailto:/.test(t))&&(r="mailto:"+r),{rng:b,url:r}}return null},k=(e,t)=>{let{dom:r,selection:n}=e,{rng:i,url:s}=t,d=n.getBookmark();n.setRng(i);let u="createlink",c={command:u,ui:!1,value:s};if(!e.dispatch("BeforeExecCommand",c).isDefaultPrevented()){e.getDoc().execCommand(u,!1,s),e.dispatch("ExecCommand",c);let t=o(e);if(a(t)){let o=n.getNode();r.setAttrib(o,"target",t),"_blank"!==t||l(e)||r.setAttrib(o,"rel","noopener")}}n.moveToBookmark(d),e.nodeChanged()},p=e=>{let t=m(e,-1);s(t)&&k(e,t)};e.add("autolink",e=>{(e=>{let t=e.options.register;t("autolink_pattern",{processor:"regexp",default:RegExp("^"+/(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)[A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+))?/g.source+"$","i")}),t("link_default_target",{processor:"string"}),t("link_default_protocol",{processor:"string",default:"https"})})(e),e.on("keydown",t=>{13!==t.keyCode||t.isDefaultPrevented()||(e=>{let t=m(e,0);s(t)&&k(e,t)})(e)}),e.on("keyup",t=>{32===t.keyCode?p(e):(48===t.keyCode&&t.shiftKey||221===t.keyCode)&&p(e)})})}();