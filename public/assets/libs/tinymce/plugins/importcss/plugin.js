!function(){"use strict";let e;var t=tinymce.util.Tools.resolve("tinymce.PluginManager");let r=(e,t,r)=>{var s;return!!r(e,t.prototype)||(null===(s=e.constructor)||void 0===s?void 0:s.name)===t.name},s=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&r(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},o=e=>t=>s(t)===e,l=o("string"),i=o("object"),n=o("array"),c=(e="function",t=>typeof t===e);var a=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),p=tinymce.util.Tools.resolve("tinymce.EditorManager"),u=tinymce.util.Tools.resolve("tinymce.Env"),m=tinymce.util.Tools.resolve("tinymce.util.Tools");let f=e=>t=>t.options.get(e),y=e=>{let t=e.options.register,r=e=>l(e)||c(e)||i(e);t("importcss_merge_classes",{processor:"boolean",default:!0}),t("importcss_exclusive",{processor:"boolean",default:!0}),t("importcss_selector_converter",{processor:"function"}),t("importcss_selector_filter",{processor:r}),t("importcss_file_filter",{processor:r}),t("importcss_groups",{processor:"object[]"}),t("importcss_append",{processor:"boolean",default:!1})},d=f("importcss_merge_classes"),h=f("importcss_exclusive"),g=f("importcss_selector_converter"),_=f("importcss_selector_filter"),v=f("importcss_groups"),b=f("importcss_append"),x=f("importcss_file_filter"),T=f("skin"),S=f("skin_url"),k=Array.prototype.push,M=(e,t)=>{let r=e.length,s=Array(r);for(let o=0;o<r;o++){let r=e[o];s[o]=t(r,o)}return s},A=e=>{let t=[];for(let r=0,s=e.length;r<s;++r){if(!n(e[r]))throw Error("Arr.flatten item "+r+" was not an array, input: "+e);k.apply(t,e[r])}return t},E=(e,t)=>A(M(e,t)),I=()=>{let e=[],t=[],r={};return{addItemToGroup:(e,s)=>{r[e]?r[e].push(s):(t.push(e),r[e]=[s])},addItem:t=>{e.push(t)},toFormats:()=>E(t,e=>{let t=r[e];return 0===t.length?[]:[{title:e,items:t}]}).concat(e)}},j=/^\.(?:ephox|tiny-pageembed|mce)(?:[.-]+\w+)+$/,O=e=>{let t=u.cacheSuffix;return l(e)&&(e=e.replace("?"+t,"").replace("&"+t,"")),e},R=(e,t)=>{let r=T(e);if(r){let s=S(e),o=s?e.documentBaseURI.toAbsolute(s):p.baseURL+"/skins/ui/"+r,l=p.baseURL+"/skins/content/",i=e.editorManager.suffix;return t===o+"/content"+(e.inline?".inline":"")+`${i}.css`||-1!==t.indexOf(l)}return!1},w=e=>l(e)?t=>-1!==t.indexOf(e):e instanceof RegExp?t=>e.test(t):e,U=e=>e.styleSheet,B=e=>e.selectorText,D=(e,t,r)=>{let s=[],o={},l=(t,o)=>{let i,n=t.href;if(!(!(n=O(n))||r&&!r(n,o)||R(e,n))){m.each(t.imports,e=>{l(e,!0)});try{i=t.cssRules||t.rules}catch(e){}m.each(i,e=>{U(e)&&e.styleSheet?l(e.styleSheet,!0):B(e)&&m.each(e.selectorText.split(","),e=>{s.push(m.trim(e))})})}};m.each(e.contentCSS,e=>{o[e]=!0}),r||(r=(e,t)=>t||o[e]);try{m.each(t.styleSheets,e=>{l(e)})}catch(e){}return s},F=(e,t)=>{let r={},s=/^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(t);if(!s)return;let o=s[1],l=s[2].substr(1).split(".").join(" "),i=m.makeMap("a,img");return s[1]?(r={title:t},e.schema.getTextBlockElements()[o]?r.block=o:e.schema.getBlockElements()[o]||i[o.toLowerCase()]?r.selector=o:r.inline=o):s[2]&&(r={inline:"span",title:t.substr(1),classes:l}),d(e)?r.classes=l:r.attributes={class:l},r},L=(e,t)=>m.grep(e,e=>!e.filter||e.filter(t)),$=e=>m.map(e,e=>m.extend({},e,{original:e,selectors:{},filter:w(e.filter)})),z=(e,t)=>null===t||h(e),C=(e,t,r,s)=>!(z(e,r)?t in s:t in r.selectors),G=(e,t,r,s)=>{z(e,r)?s[t]=!0:r.selectors[t]=!0},P=(e,t,r,s)=>{let o=g(e);return(s&&s.selector_converter?s.selector_converter:o||(()=>F(e,r))).call(t,r,s)},q=e=>{e.on("init",()=>{let t=I(),r={},s=w(_(e)),o=$(v(e)),l=(t,s)=>{if(C(e,t,s,r)){G(e,t,s,r);let o=P(e,e.plugins.importcss,t,s);if(o){let t=o.name||a.DOM.uniqueId();return e.formatter.register(t,o),{title:o.title,format:t}}}return null};m.each(D(e,e.getDoc(),w(x(e))),e=>{if(!j.test(e)&&(!s||s(e))){let r=L(o,e);if(r.length>0)m.each(r,r=>{let s=l(e,r);s&&t.addItemToGroup(r.title,s)});else{let r=l(e,null);r&&t.addItem(r)}}});let i=t.toFormats();e.dispatch("addStyleModifications",{items:i,replace:!b(e)})})},H=e=>({convertSelectorToFormat:t=>F(e,t)});t.add("importcss",e=>(y(e),q(e),H(e)))}();