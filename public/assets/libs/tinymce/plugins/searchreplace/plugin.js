!function(){"use strict";let e=e=>{let t=e;return{get:()=>t,set:e=>{t=e}}};var t=tinymce.util.Tools.resolve("tinymce.PluginManager");let n=(e,t,n)=>{var r;return!!n(e,t.prototype)||(null===(r=e.constructor)||void 0===r?void 0:r.name)===t.name},r=e=>{let t=typeof e;return null===e?"null":"object"===t&&Array.isArray(e)?"array":"object"===t&&n(e,String,(e,t)=>t.isPrototypeOf(e))?"string":t},u=e=>t=>r(t)===e,l=e=>t=>typeof t===e,o=u("string"),a=u("array"),s=l("boolean"),i=e=>null==e,d=e=>!i(e),c=l("number"),m=()=>{},h=e=>()=>e,g=h(!0),f=h(`[~\u2116|!-*+-\\/:;?@\\[-\`{}\u00A1\u00AB\u00B7\u00BB\u00BF;\u00B7\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1361-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u3008\u3009\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30\u2E31\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]`);class p{constructor(e,t){this.tag=e,this.value=t}static some(e){return new p(!0,e)}static none(){return p.singletonNone}fold(e,t){return this.tag?t(this.value):e()}isSome(){return this.tag}isNone(){return!this.tag}map(e){return this.tag?p.some(e(this.value)):p.none()}bind(e){return this.tag?e(this.value):p.none()}exists(e){return this.tag&&e(this.value)}forall(e){return!this.tag||e(this.value)}filter(e){return!this.tag||e(this.value)?this:p.none()}getOr(e){return this.tag?this.value:e}or(e){return this.tag?this:e}getOrThunk(e){return this.tag?this.value:e()}orThunk(e){return this.tag?this:e()}getOrDie(e){if(this.tag)return this.value;throw Error(null!=e?e:"Called getOrDie on None")}static from(e){return d(e)?p.some(e):p.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(e){this.tag&&e(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}p.singletonNone=new p(!1);var F=tinymce.util.Tools.resolve("tinymce.Env"),A=tinymce.util.Tools.resolve("tinymce.util.Tools");let y=Array.prototype.slice,E=Array.prototype.push,x=(e,t)=>{let n=e.length,r=Array(n);for(let u=0;u<n;u++){let n=e[u];r[u]=t(n,u)}return r},D=(e,t)=>{for(let n=0,r=e.length;n<r;n++)t(e[n],n)},b=(e,t)=>{for(let n=e.length-1;n>=0;n--)t(e[n],n)},C=(e,t)=>{if(0===e.length)return[];{let n=t(e[0]),r=[],u=[];for(let l=0,o=e.length;l<o;l++){let o=e[l],a=t(o);a!==n&&(r.push(u),u=[]),n=a,u.push(o)}return 0!==u.length&&r.push(u),r}},v=(e,t,n)=>(D(e,(e,r)=>{n=t(n,e,r)}),n),w=e=>{let t=[];for(let n=0,r=e.length;n<r;++n){if(!a(e[n]))throw Error("Arr.flatten item "+n+" was not an array, input: "+e);E.apply(t,e[n])}return t},B=(e,t)=>w(x(e,t)),N=(e,t)=>{let n=y.call(e,0);return n.sort(t),n},O=Object.hasOwnProperty,T=(e,t)=>O.call(e,t);"undefined"!=typeof window?window:Function("return this;")();let k=e=>e.dom.nodeType,S=(e,t,n)=>{if(o(n)||s(n)||c(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),Error("Attribute value was not simple")},I=(e,t,n)=>{S(e.dom,t,n)},M={fromDom:e=>{if(null==e)throw Error("Node cannot be null or undefined");return{dom:e}}},R=e=>1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType||0===e.childElementCount,P=(e,t)=>{let n=void 0===t?document:t.dom;return R(n)?[]:x(n.querySelectorAll(e),M.fromDom)},W=e=>p.from(e.dom.parentNode).map(M.fromDom),$=e=>x(e.dom.childNodes,M.fromDom),V=(e,t)=>({element:e,offset:t}),j=(e,t)=>{let n=$(e);return n.length>0&&t<n.length?V(n[t],0):V(e,t)},z=(e,t)=>{W(e).each(n=>{n.dom.insertBefore(t.dom,e.dom)})},U=(e,t)=>{e.dom.appendChild(t.dom)},_=(e,t)=>{z(e,t),U(t,e)},q=((e,t)=>{let n=t=>e(t)?p.from(t.dom.nodeValue):p.none();return{get:r=>{if(!e(r))throw Error("Can only get "+t+" value of a "+t+" node");return n(r).getOr("")},getOption:n,set:(n,r)=>{if(!e(n))throw Error("Can only set raw "+t+" value of a "+t+" node");n.dom.nodeValue=r}}})(e=>3===k(e),"text"),G=e=>q.get(e),K=(e,t,n)=>(e.compareDocumentPosition(t)&n)!=0,H=(e,t)=>K(e,t,Node.DOCUMENT_POSITION_PRECEDING),J=(e,t)=>P(t,e);var L=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker");let Q=(e,t)=>e.isBlock(t)||T(e.schema.getVoidElements(),t.nodeName),X=(e,t)=>!e.isEditable(t),Y=(e,t)=>"true"===e.getContentEditable(t)&&t.parentNode&&!e.isEditable(t.parentNode),Z=(e,t)=>!e.isBlock(t)&&T(e.schema.getWhitespaceElements(),t.nodeName),ee=(e,t)=>Q(e,t)||X(e,t)||Z(e,t)||Y(e,t),et=e=>3===e.nodeType,en=()=>({sOffset:0,fOffset:0,elements:[]}),er=(e,t)=>j(M.fromDom(e),t),eu=(e,t,n,r,u,l=!0)=>{let o=l?t(!1):n;for(;o;){let n=X(e,o);if(n||Z(e,o)){if(n?r.cef(o):r.boundary(o))break;o=t(!0);continue}if(Q(e,o)){if(r.boundary(o))break}else et(o)&&r.text(o);if(o===u)break;o=t(!1)}},el=(e,t,n,r,u)=>{var l;if(ee(e,n))return;let o=new L(n,null!==(l=e.getParent(r,e.isBlock))&&void 0!==l?l:e.getRoot());eu(e,u?o.next.bind(o):o.prev.bind(o),n,{boundary:g,cef:g,text:e=>{u?t.fOffset+=e.length:t.sOffset+=e.length,t.elements.push(M.fromDom(e))}})},eo=(e,t,n,r,u,l=!0)=>{let o=new L(n,t),a=[],s=en();el(e,s,n,t,!1);let i=()=>(s.elements.length>0&&(a.push(s),s=en()),!1);return eu(e,o.next.bind(o),n,{boundary:i,cef:e=>(i(),u&&a.push(...u.cef(e)),!1),text:e=>{s.elements.push(M.fromDom(e)),u&&u.text(e,s)}},r,l),r&&el(e,s,r,t,!0),i(),a},ea=(e,t)=>{let n=er(t.startContainer,t.startOffset),r=n.element.dom,u=er(t.endContainer,t.endOffset),l=u.element.dom;return eo(e,t.commonAncestorContainer,r,l,{text:(e,t)=>{e===l?t.fOffset+=e.length-u.offset:e===r&&(t.sOffset+=n.offset)},cef:t=>N(B(J(M.fromDom(t),"*[contenteditable=true]"),t=>{let n=t.dom;return eo(e,n,n)}),(e,t)=>H(e.elements[0].dom,t.elements[0].dom)?1:-1)},!1)},es=(e,t)=>t.collapsed?[]:ea(e,t),ei=(e,t)=>{let n=e.createRng();return n.selectNode(t),es(e,n)},ed=(e,t)=>B(t,t=>ei(e,t)),ec=(e,t,n=0,r=e.length)=>{let u;let l=t.regex;l.lastIndex=n;let o=[];for(;u=l.exec(e);){let e=u[t.matchIndex],n=u.index+u[0].indexOf(e),a=n+e.length;if(a>r)break;o.push({start:n,finish:a}),l.lastIndex=a}return o},em=(e,t)=>C(v(e,(e,n)=>{let r=G(n),u=e.last,l=u+r.length,o=B(t,(e,t)=>e.start<l&&e.finish>u?[{element:n,start:Math.max(u,e.start)-u,finish:Math.min(l,e.finish)-u,matchId:t}]:[]);return{results:e.results.concat(o),last:l}},{results:[],last:0}).results,e=>e.matchId),eh=(e,t)=>B(t,t=>{let n=t.elements,r=x(n,G).join("");return em(n,ec(r,e,t.sOffset,r.length-t.fOffset))}),eg=(e,t)=>{b(e,(e,n)=>{b(e,e=>{let r=M.fromDom(t.cloneNode(!1));I(r,"data-mce-index",n);let u=e.element.dom;if(u.length===e.finish&&0===e.start)_(e.element,r);else{u.length!==e.finish&&u.splitText(e.finish);let t=u.splitText(e.start);_(M.fromDom(t),r)}})})},ef=(e,t,n,r)=>{let u=eh(t,ei(e,n));return eg(u,r),u.length},ep=(e,t,n,r)=>{let u=n.getBookmark(),l=e.select("td[data-mce-selected],th[data-mce-selected]"),o=eh(t,l.length>0?ed(e,l):es(e,n.getRng()));return eg(o,r),n.moveToBookmark(u),o.length},eF=e=>e.getAttribute("data-mce-index"),eA=(e,t,n,r)=>{let u=e.dom.create("span",{"data-mce-bogus":1});u.className="mce-match-marker";let l=e.getBody();return(eO(e,t,!1),r)?ep(e.dom,n,e.selection,u):ef(e.dom,n,l,u)},ey=e=>{var t;let n=e.parentNode;e.firstChild&&n.insertBefore(e.firstChild,e),null===(t=e.parentNode)||void 0===t||t.removeChild(e)},eE=(e,t)=>{let n=[],r=A.toArray(e.getBody().getElementsByTagName("span"));if(r.length)for(let e=0;e<r.length;e++){let u=eF(r[e]);null!==u&&u.length&&u===t.toString()&&n.push(r[e])}return n},ex=(e,t,n)=>{let r=t.get(),u=r.index,l=e.dom;n?u+1===r.count?u=0:u++:u-1==-1?u=r.count-1:u--,l.removeClass(eE(e,r.index),"mce-match-marker-selected");let o=eE(e,u);return o.length?(l.addClass(eE(e,u),"mce-match-marker-selected"),e.selection.scrollIntoView(o[0]),u):-1},eD=(e,t)=>{let n=t.parentNode;e.remove(t),n&&e.isEmpty(n)&&e.remove(n)},eb=(e,t)=>{let n="("+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n\\uFEFF]")+")";return t?`(?:^|\\s|${f()})`+n+`(?=$|\\s|${f()})`:n},eC=(e,t,n,r,u,l)=>{let o=e.selection,a=eb(n,u),s=o.isForward(),i=eA(e,t,{regex:new RegExp(a,r?"g":"gi"),matchIndex:1},l);if(F.browser.isSafari()&&o.setRng(o.getRng(),s),i){let o=ex(e,t,!0);t.set({index:o,count:i,text:n,matchCase:r,wholeWord:u,inSelection:l})}return i},ev=(e,t)=>{let n=ex(e,t,!0);t.set({...t.get(),index:n})},ew=(e,t)=>{let n=ex(e,t,!1);t.set({...t.get(),index:n})},eB=e=>{let t=eF(e);return null!==t&&t.length>0},eN=(e,t,n,r,u)=>{let l=t.get(),o=l.index,a,s=o;r=!1!==r;let i=e.getBody(),d=A.grep(A.toArray(i.getElementsByTagName("span")),eB);for(let t=0;t<d.length;t++){let i=a=parseInt(eF(d[t]),10);if(u||i===l.index){for(n.length?(d[t].innerText=n,ey(d[t])):eD(e.dom,d[t]);d[++t];)if((i=parseInt(eF(d[t]),10))===a)eD(e.dom,d[t]);else{t--;break}r&&s--}else a>o&&d[t].setAttribute("data-mce-index",String(a-1))}return t.set({...l,count:u?0:l.count-1,index:s}),r?ev(e,t):ew(e,t),!u&&t.get().count>0},eO=(e,t,n)=>{let r,u;let l=t.get(),o=A.toArray(e.getBody().getElementsByTagName("span"));for(let e=0;e<o.length;e++){let t=eF(o[e]);null!==t&&t.length&&(t===l.index.toString()&&(r||(r=o[e].firstChild),u=o[e].firstChild),ey(o[e]))}if(t.set({...l,index:-1,count:0,text:""}),r&&u){let t=e.dom.createRng();return t.setStart(r,0),t.setEnd(u,u.data.length),!1!==n&&e.selection.setRng(t),t}},eT=(e,t)=>t.get().count>1,ek=(e,t)=>t.get().count>1,eS=(e,t)=>({done:n=>eO(e,t,n),find:(n,r,u,l=!1)=>eC(e,t,n,r,u,l),next:()=>ev(e,t),prev:()=>ew(e,t),replace:(n,r,u)=>eN(e,t,n,r,u)}),eI=t=>{let n=e(p.none()),r=()=>n.get().each(t);return{clear:()=>{r(),n.set(p.none())},isSet:()=>n.get().isSome(),get:()=>n.get(),set:e=>{r(),n.set(p.some(e))}}},eM=()=>{let e=eI(m);return{...e,on:t=>e.get().each(t)}},eR=(e,t)=>{let n=eM();e.undoManager.add();let r=A.trim(e.selection.getContent({format:"text"})),u=n=>{n.setEnabled("next",eT(e,t)),n.setEnabled("prev",ek(e,t))},l=e=>{let n=e.getData(),r=t.get();t.set({...r,matchCase:n.matchcase,wholeWord:n.wholewords,inSelection:n.inselection})},o=(e,t)=>{D(["replace","replaceall","prev","next"],n=>e.setEnabled(n,!t))},a=(e,t)=>{t.redial(g(e,t.getData()))},s=(e,t)=>{F.browser.isSafari()&&F.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},i=n=>{eO(e,t,!1),o(n,!0),u(n)},d=n=>{let r=n.getData(),l=t.get();if(!r.findtext.length){i(n);return}if(l.text===r.findtext&&l.matchCase===r.matchcase&&l.wholeWord===r.wholewords)ev(e,t);else{let u=eC(e,t,r.findtext,r.matchcase,r.wholewords,r.inselection);u<=0&&a(!0,n),o(n,0===u)}u(n)},c=t.get(),m={findtext:r,replacetext:"",wholewords:c.wholeWord,matchcase:c.matchCase,inselection:c.inSelection},h=e=>{let t=[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",enabled:!1,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",enabled:!1,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}];return e&&t.push({type:"alertbanner",level:"error",text:"Could not find the specified string.",icon:"warning"}),t},g=(n,r)=>({title:"Find and Replace",size:"normal",body:{type:"panel",items:h(n)},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"},{type:"togglemenuitem",name:"inselection",text:"Find in selection"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",enabled:!1},{type:"custom",name:"replaceall",text:"Replace all",enabled:!1}],initialData:r,onChange:(e,r)=>{n&&a(!1,e),"findtext"===r.name&&t.get().count>0&&i(e)},onAction:(n,r)=>{let o=n.getData();switch(r.name){case"find":d(n);break;case"replace":eN(e,t,o.replacetext)?u(n):i(n);break;case"replaceall":eN(e,t,o.replacetext,!0,!0),i(n);break;case"prev":ew(e,t),u(n);break;case"next":ev(e,t),u(n);break;case"matchcase":case"wholewords":case"inselection":a(!1,n),l(n),i(n)}s(n,r.name)},onSubmit:e=>{d(e),s(e,"find")},onClose:()=>{e.focus(),eO(e,t),e.undoManager.add()}});n.set(e.windowManager.open(g(!1,m),{inline:"toolbar"}))},eP=(e,t)=>{e.addCommand("SearchReplace",()=>{eR(e,t)})},eW=(e,t)=>()=>{eR(e,t)},e$=(e,t)=>{e.ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:eW(e,t),icon:"search"}),e.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:eW(e,t),icon:"search",shortcut:"Meta+F"}),e.shortcuts.add("Meta+F","",eW(e,t))};t.add("searchreplace",t=>{let n=e({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1,inSelection:!1});return eP(t,n),e$(t,n),eS(t,n)})}();